import{n as ie,l as re}from"./index.Ll155AD0.js";import{r as se,u as ae,v as ce,w as ue}from"./scheduler._iQzioK7.js";import{w as J,r as de}from"./index.ULDeJKQe.js";function je(e){return e?.length!==void 0?e:Array.from(e)}function le(e,t){re(e,1,1,()=>{t.delete(e.key)})}function ze(e,t){e.f(),le(e,t)}function Ue(e,t,o,r,i,a,s,c,u,l,f,y){let d=e.length,h=a.length,w=d;const L={};for(;w--;)L[e[w].key]=w;const I=[],D=new Map,F=new Map,B=[];for(w=h;w--;){const m=y(i,a,w),v=o(m);let _=s.get(v);_?r&&B.push(()=>_.p(m,t)):(_=l(v,m),_.c()),D.set(v,I[w]=_),v in L&&F.set(v,Math.abs(w-L[v]))}const W=new Set,K=new Set;function x(m){ie(m,1),m.m(c,f),s.set(m.key,m),f=m.first,h--}for(;d&&h;){const m=I[h-1],v=e[d-1],_=m.key,P=v.key;m===v?(f=m.first,d--,h--):D.has(P)?!s.has(_)||W.has(_)?x(m):K.has(P)?d--:F.get(_)>F.get(P)?(K.add(_),x(m)):(W.add(P),d--):(u(v,s),d--)}for(;d--;){const m=e[d];D.has(m.key)||u(m,s)}for(;h;)x(I[h-1]);return se(B),I}function ke(e,t){const o={},r={},i={$$scope:1};let a=e.length;for(;a--;){const s=e[a],c=t[a];if(c){for(const u in s)u in c||(r[u]=1);for(const u in c)i[u]||(o[u]=c[u],i[u]=1);e[a]=c}else for(const u in s)i[u]=1}for(const s in r)s in o||(o[s]=void 0);return o}var g={},fe,me,ge,pe,we;function p(e,t,o,r){return new(o||(o=Promise))(function(i,a){function s(l){try{u(r.next(l))}catch(f){a(f)}}function c(l){try{u(r.throw(l))}catch(f){a(f)}}function u(l){var f;l.done?i(l.value):(f=l.value,f instanceof o?f:new o(function(y){y(f)})).then(s,c)}u((r=r.apply(e,t||[])).next())})}function M(){return n("extensions.getStats")}Object.defineProperty(g,"__esModule",{value:!0});var he=Object.freeze({__proto__:null,dispatch:function(e,t,o){return new Promise((r,i)=>p(this,void 0,void 0,function*(){let a=yield M();if(a.loaded.includes(e))if(a.connected.includes(e))try{let s=yield n("extensions.dispatch",{extensionId:e,event:t,data:o});r(s)}catch(s){i(s)}else(function(s,c){s in N?N[s].push(c):N[s]=[c]})(e,{method:"extensions.dispatch",data:{extensionId:e,event:t,data:o},resolve:r,reject:i});else i({code:"NE_EX_EXTNOTL",message:`${e} is not loaded`})}))},broadcast:function(e,t){return n("extensions.broadcast",{event:e,data:t})},getStats:M});function S(e,t){return window.addEventListener(e,t),Promise.resolve({success:!0,message:"Event listener added"})}function E(e,t){let o=new CustomEvent(e,{detail:t});return window.dispatchEvent(o),Promise.resolve({success:!0,message:"Message dispatched"})}function Q(e){let t=window.atob(e),o=t.length,r=new Uint8Array(o);for(let i=0;i<o;i++)r[i]=t.charCodeAt(i);return r.buffer}let O,R={},q=[],N={};function ve(){window.NL_TOKEN&&sessionStorage.setItem("NL_TOKEN",window.NL_TOKEN),O=new WebSocket(`ws://${window.location.hostname}:${window.NL_PORT}`),function(){S("ready",()=>p(this,void 0,void 0,function*(){if(yield Y(q),!window.NL_EXTENABLED)return;let e=yield M();for(let t of e.connected)E("extensionReady",t)})),S("extClientConnect",e=>{E("extensionReady",e.detail)}),window.NL_EXTENABLED&&S("extensionReady",e=>p(this,void 0,void 0,function*(){e.detail in N&&(yield Y(N[e.detail]),delete N[e.detail])}))}(),function(){O.addEventListener("message",e=>{var t,o,r;const i=JSON.parse(e.data);i.id&&i.id in R?(!((t=i.data)===null||t===void 0)&&t.error?(R[i.id].reject(i.data.error),i.data.error.code=="NE_RT_INVTOKN"&&(O.close(),document.body.innerText="",document.write("<code>NE_RT_INVTOKN</code>: Neutralinojs application configuration prevents accepting native calls from this client."))):!((o=i.data)===null||o===void 0)&&o.success&&R[i.id].resolve(i.data.hasOwnProperty("returnValue")?i.data.returnValue:i.data),delete R[i.id]):i.event&&(i.event=="openedFile"&&((r=i?.data)===null||r===void 0?void 0:r.action)=="dataBinary"&&(i.data.data=Q(i.data.data)),E(i.event,i.data))}),O.addEventListener("open",e=>p(this,void 0,void 0,function*(){E("ready")})),O.addEventListener("close",e=>p(this,void 0,void 0,function*(){E("serverOffline",{code:"NE_CL_NSEROFF",message:"Neutralino server is offline. Try restarting the application"})}))}()}function n(e,t){return new Promise((o,r)=>{if(O?.readyState!=WebSocket.OPEN)return i={method:e,data:t,resolve:o,reject:r},void q.push(i);var i;const a="10000000-1000-4000-8000-100000000000".replace(/[018]/g,c=>(c^crypto.getRandomValues(new Uint8Array(1))[0]&15>>c/4).toString(16)),s=window.NL_TOKEN||sessionStorage.getItem("NL_TOKEN")||"";R[a]={resolve:o,reject:r},O.send(JSON.stringify({id:a,method:e,data:t,accessToken:s}))})}function Y(e){return p(this,void 0,void 0,function*(){for(;e.length>0;){let t=e.shift();try{let o=yield n(t.method,t.data);t.resolve(o)}catch(o){t.reject(o)}}})}function Z(e,t){return n("filesystem.writeBinaryFile",{path:e,data:ee(t)})}function ee(e){let t=new Uint8Array(e),o="";for(let r of t)o+=String.fromCharCode(r);return window.btoa(o)}var A,j,_e=Object.freeze({__proto__:null,createDirectory:function(e){return n("filesystem.createDirectory",{path:e})},removeDirectory:function(e){return n("filesystem.removeDirectory",{path:e})},writeFile:function(e,t){return n("filesystem.writeFile",{path:e,data:t})},appendFile:function(e,t){return n("filesystem.appendFile",{path:e,data:t})},writeBinaryFile:Z,appendBinaryFile:function(e,t){return n("filesystem.appendBinaryFile",{path:e,data:ee(t)})},readFile:function(e,t){return n("filesystem.readFile",Object.assign({path:e},t))},readBinaryFile:function(e,t){return new Promise((o,r)=>{n("filesystem.readBinaryFile",Object.assign({path:e},t)).then(i=>{o(Q(i))}).catch(i=>{r(i)})})},openFile:function(e){return n("filesystem.openFile",{path:e})},createWatcher:function(e){return n("filesystem.createWatcher",{path:e})},removeWatcher:function(e){return n("filesystem.removeWatcher",{id:e})},getWatchers:function(){return n("filesystem.getWatchers")},updateOpenedFile:function(e,t,o){return n("filesystem.updateOpenedFile",{id:e,event:t,data:o})},getOpenedFileInfo:function(e){return n("filesystem.getOpenedFileInfo",{id:e})},removeFile:function(e){return n("filesystem.removeFile",{path:e})},readDirectory:function(e){return n("filesystem.readDirectory",{path:e})},copyFile:function(e,t){return n("filesystem.copyFile",{source:e,destination:t})},moveFile:function(e,t){return n("filesystem.moveFile",{source:e,destination:t})},getStats:function(e){return n("filesystem.getStats",{path:e})}});function U(e,t){return n("os.execCommand",Object.assign({command:e},t))}(function(e){e.WARNING="WARNING",e.ERROR="ERROR",e.INFO="INFO",e.QUESTION="QUESTION"})(A||(A={})),function(e){e.OK="OK",e.OK_CANCEL="OK_CANCEL",e.YES_NO="YES_NO",e.YES_NO_CANCEL="YES_NO_CANCEL",e.RETRY_CANCEL="RETRY_CANCEL",e.ABORT_RETRY_IGNORE="ABORT_RETRY_IGNORE"}(j||(j={}));var ye=Object.freeze({__proto__:null,get Icon(){return A},get MessageBoxChoice(){return j},execCommand:U,spawnProcess:function(e,t){return n("os.spawnProcess",{command:e,cwd:t})},updateSpawnedProcess:function(e,t,o){return n("os.updateSpawnedProcess",{id:e,event:t,data:o})},getSpawnedProcesses:function(){return n("os.getSpawnedProcesses")},getEnv:function(e){return n("os.getEnv",{key:e})},getEnvs:function(){return n("os.getEnvs")},showOpenDialog:function(e,t){return n("os.showOpenDialog",Object.assign({title:e},t))},showFolderDialog:function(e,t){return n("os.showFolderDialog",Object.assign({title:e},t))},showSaveDialog:function(e,t){return n("os.showSaveDialog",Object.assign({title:e},t))},showNotification:function(e,t,o){return n("os.showNotification",{title:e,content:t,icon:o})},showMessageBox:function(e,t,o,r){return n("os.showMessageBox",{title:e,content:t,choice:o,icon:r})},setTray:function(e){return n("os.setTray",e)},open:function(e){return n("os.open",{url:e})},getPath:function(e){return n("os.getPath",{name:e})}}),Oe=Object.freeze({__proto__:null,getMemoryInfo:function(){return n("computer.getMemoryInfo")},getArch:function(){return n("computer.getArch")},getKernelInfo:function(){return n("computer.getKernelInfo")},getOSInfo:function(){return n("computer.getOSInfo")},getCPUInfo:function(){return n("computer.getCPUInfo")},getDisplays:function(){return n("computer.getDisplays")},getMousePosition:function(){return n("computer.getMousePosition")}}),z,Ee=Object.freeze({__proto__:null,setData:function(e,t){return n("storage.setData",{key:e,data:t})},getData:function(e){return n("storage.getData",{key:e})},getKeys:function(){return n("storage.getKeys")}});function te(e,t){return n("debug.log",{message:e,type:t})}(function(e){e.WARNING="WARNING",e.ERROR="ERROR",e.INFO="INFO"})(z||(z={}));var Ne=Object.freeze({__proto__:null,get LoggerType(){return z},log:te});function V(e){return n("app.exit",{code:e})}var be=Object.freeze({__proto__:null,exit:V,killProcess:function(){return n("app.killProcess")},restartProcess:function(e){return new Promise(t=>p(this,void 0,void 0,function*(){let o=window.NL_ARGS.reduce((r,i)=>(i.includes(" ")&&(i=`"${i}"`),r+=" "+i),"");e?.args&&(o+=" "+e.args),yield U(o,{background:!0}),V(),t()}))},getConfig:function(){return n("app.getConfig")},broadcast:function(e,t){return n("app.broadcast",{event:e,data:t})}});const b=new WeakMap;function G(e,t){return n("window.move",{x:e,y:t})}function $(){return n("window.getSize")}var Te=Object.freeze({__proto__:null,setTitle:function(e){return n("window.setTitle",{title:e})},getTitle:function(){return n("window.getTitle")},maximize:function(){return n("window.maximize")},unmaximize:function(){return n("window.unmaximize")},isMaximized:function(){return n("window.isMaximized")},minimize:function(){return n("window.minimize")},setFullScreen:function(){return n("window.setFullScreen")},exitFullScreen:function(){return n("window.exitFullScreen")},isFullScreen:function(){return n("window.isFullScreen")},show:function(){return n("window.show")},hide:function(){return n("window.hide")},isVisible:function(){return n("window.isVisible")},focus:function(){return n("window.focus")},setIcon:function(e){return n("window.setIcon",{icon:e})},move:G,center:function(){return n("window.center")},setDraggableRegion:function(e){return new Promise((t,o)=>{const r=e instanceof Element?e:document.getElementById(e);let i=0,a=0,s=0,c=!1,u=performance.now();if(!r)return o({code:"NE_WD_DOMNOTF",message:"Unable to find DOM element"});if(b.has(r))return o({code:"NE_WD_ALRDREL",message:"This DOM element is already an active draggable region"});function l(d){return p(this,void 0,void 0,function*(){if(c){const h=performance.now(),w=h-u;return w<5?void 0:(u=h-(w-5),void(yield G(d.screenX-i,d.screenY-a)))}s=Math.sqrt(d.movementX*d.movementX+d.movementY*d.movementY),s>=10&&(c=!0,r.setPointerCapture(d.pointerId))})}function f(d){d.button===0&&(i=d.clientX,a=d.clientY,r.addEventListener("pointermove",l))}function y(d){r.removeEventListener("pointermove",l),r.releasePointerCapture(d.pointerId)}r.addEventListener("pointerdown",f),r.addEventListener("pointerup",y),b.set(r,{pointerdown:f,pointerup:y}),t({success:!0,message:"Draggable region was activated"})})},unsetDraggableRegion:function(e){return new Promise((t,o)=>{const r=e instanceof Element?e:document.getElementById(e);if(!r)return o({code:"NE_WD_DOMNOTF",message:"Unable to find DOM element"});if(!b.has(r))return o({code:"NE_WD_NOTDRRE",message:"DOM element is not an active draggable region"});const{pointerdown:i,pointerup:a}=b.get(r);r.removeEventListener("pointerdown",i),r.removeEventListener("pointerup",a),b.delete(r),t({success:!0,message:"Draggable region was deactivated"})})},setSize:function(e){return new Promise((t,o)=>p(this,void 0,void 0,function*(){let r=yield $();n("window.setSize",e=Object.assign(Object.assign({},r),e)).then(i=>{t(i)}).catch(i=>{o(i)})}))},getSize:$,getPosition:function(){return n("window.getPosition")},setAlwaysOnTop:function(e){return n("window.setAlwaysOnTop",{onTop:e})},create:function(e,t){return new Promise((o,r)=>{function i(s){return typeof s!="string"||(s=s.trim()).includes(" ")&&(s=`"${s}"`),s}t=Object.assign(Object.assign({},t),{useSavedState:!1});let a=window.NL_ARGS.reduce((s,c,u)=>((c.includes("--path=")||c.includes("--debug-mode")||c.includes("--load-dir-res")||u==0)&&(s+=" "+i(c)),s),"");a+=" --url="+i(e);for(let s in t)s!="processArgs"&&(a+=` --window${s.replace(/[A-Z]|^[a-z]/g,c=>"-"+c.toLowerCase())}=${i(t[s])}`);t&&t.processArgs&&(a+=" "+t.processArgs),U(a,{background:!0}).then(s=>{o(s)}).catch(s=>{r(s)})})}}),Re=Object.freeze({__proto__:null,broadcast:function(e,t){return n("events.broadcast",{event:e,data:t})},on:S,off:function(e,t){return window.removeEventListener(e,t),Promise.resolve({success:!0,message:"Event listener removed"})},dispatch:E});let T=null;var Se=Object.freeze({__proto__:null,checkForUpdates:function(e){return new Promise((t,o)=>p(this,void 0,void 0,function*(){if(!e)return o({code:"NE_RT_NATRTER",message:"Missing require parameter: url"});try{let r=yield fetch(e);T=JSON.parse(yield r.text()),function(i){return!!(i.applicationId&&i.applicationId==window.NL_APPID&&i.version&&i.resourcesURL)}(T)?t(T):o({code:"NE_UP_CUPDMER",message:"Invalid update manifest or mismatching applicationId"})}catch{o({code:"NE_UP_CUPDERR",message:"Unable to fetch update manifest"})}}))},install:function(){return new Promise((e,t)=>p(this,void 0,void 0,function*(){if(!T)return t({code:"NE_UP_UPDNOUF",message:"No update manifest loaded"});try{let o=yield fetch(T.resourcesURL),r=yield o.arrayBuffer();yield Z(window.NL_PATH+"/resources.neu",r),e({success:!0,message:"Update installed. Restart the process to see updates"})}catch{t({code:"NE_UP_UPDINER",message:"Update installation error"})}}))}}),Ie=Object.freeze({__proto__:null,readText:function(e,t){return n("clipboard.readText",{key:e,data:t})},writeText:function(e){return n("clipboard.writeText",{data:e})}}),Pe=Object.freeze({__proto__:null,getMethods:function(){return n("custom.getMethods")}});let X=!1;we=g.app=be,g.clipboard=Ie,g.computer=Oe,g.custom=Pe,g.debug=Ne,g.events=Re,g.extensions=he,pe=g.filesystem=_e,ge=g.init=function(e={}){if(e=Object.assign({exportCustomMethods:!0},e),!X){if(ve(),window.NL_ARGS.find(t=>t=="--neu-dev-auto-reload")&&S("neuDev_reloadApp",()=>p(this,void 0,void 0,function*(){yield te("Reloading the application..."),location.reload()})),e.exportCustomMethods&&window.NL_CMETHODS&&window.NL_CMETHODS.length>0)for(let t of window.NL_CMETHODS)Neutralino.custom[t]=(...o)=>{let r={};for(let[i,a]of o.entries())r=typeof a!="object"||Array.isArray(a)||a==null?Object.assign(Object.assign({},r),{["arg"+i]:a}):Object.assign(Object.assign({},r),a);return n("custom."+t,r)};window.NL_CVERSION="3.13.0",window.NL_CCOMMIT="26e9ccc7986db4fb7df7041ea7c90b3d2ed1093e",X=!0}},me=g.os=ye,g.storage=Ee,g.updater=Se,fe=g.window=Te;const Le={message:"Missing Toast Message",autohide:!0,timeout:5e3},ne="toastStore";function Be(){const e=ce(ne);if(!e)throw new Error("toastStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return e}function We(){const e=Fe();return ae(ne,e)}function De(){const e=Math.random();return Number(e).toString(32)}function Fe(){const{subscribe:e,set:t,update:o}=J([]),r=a=>o(s=>{if(s.length>0){const c=s.findIndex(l=>l.id===a),u=s[c];u&&(u.callback&&u.callback({id:a,status:"closed"}),u.timeoutId&&clearTimeout(u.timeoutId),s.splice(c,1))}return s});function i(a){if(a.autohide===!0)return setTimeout(()=>{r(a.id)},a.timeout)}return{subscribe:e,close:r,trigger:a=>{const s=De();return o(c=>{a&&a.callback&&a.callback({id:s,status:"queued"}),a.hideDismiss&&(a.autohide=!0);const u={...Le,...a,id:s};return u.timeoutId=i(u),c.push(u),c}),s},freeze:a=>o(s=>(s.length>0&&clearTimeout(s[a].timeoutId),s)),unfreeze:a=>o(s=>(s.length>0&&(s[a].timeoutId=i(s[a])),s)),clear:()=>t([])}}const C={};function H(e){return e==="local"?localStorage:sessionStorage}function k(e,t,o){const r=o?.serializer??JSON,i=o?.storage??"local";function a(s,c){H(i).setItem(s,r.stringify(c))}if(!C[e]){const s=J(t,l=>{const f=H(i).getItem(e);f&&l(r.parse(f));{const y=d=>{d.key===e&&l(d.newValue?r.parse(d.newValue):null)};return window.addEventListener("storage",y),()=>window.removeEventListener("storage",y)}}),{subscribe:c,set:u}=s;C[e]={set(l){a(e,l),u(l)},update(l){const f=l(ue(s));a(e,f),u(f)},subscribe:c}}return C[e]}k("modeOsPrefers",!1);k("modeUserPrefers",void 0);k("modeCurrent",!1);const oe="(prefers-reduced-motion: reduce)";function xe(){return window.matchMedia(oe).matches}const Ke=de(xe(),e=>{{const t=r=>{e(r.matches)},o=window.matchMedia(oe);return o.addEventListener("change",t),()=>{o.removeEventListener("change",t)}}});export{Be as a,ze as b,we as c,ge as d,je as e,pe as f,ke as g,We as i,me as o,Ke as p,Ue as u,fe as w};
